// Backbone.Memento v0.4.1a
//
// Copyright (C)2011 Derick Bailey, Muted Solutions, LLC
// Distributed Under MIT Liscene
//
// Documentation and Full License Availabe at:
// http://github.com/derickbailey/backbone.memento

// ----------------------------
// Backbone.Memento
// ----------------------------
(function(e){if(typeof define==="function"&&define.amd){define(["backbone","exports"],e)}else if(typeof exports==="object"){e(require("backbone"),exports)}else{e(Backbone,{})}})(function(e,t){t=function(e,t){this.version="0.4.1a";t=_.extend({ignore:[]},t);var n=new r(e,t);var s=new i(e,t);var o=function(e,t){if(!e){return}n.deserialize(e,t)};this.store=function(){var e=n.serialize();s.push(e)};this.restore=function(e){var t=s.pop();o(t,e)};this.restart=function(e){var t=s.rewind();o(t,e)}};var n=function(t){if(t instanceof e.Model){this.removeAttr=function(e){t.unset(e)};this.restore=function(e){t.set(e)}}else{this.removeAttr=function(e){t.remove(e)};this.restore=function(e){t.reset(e)}}};var r=function(e,t){function i(e,t){e=_.clone(e);if(t.hasOwnProperty("ignore")&&t.ignore.length>0){for(var n in t.ignore){var r=t.ignore[n];delete e[r]}}return e}function s(e,t){var n=[];if(!e||!t){return n}for(var r in t){if(t.hasOwnProperty(r)){if(!e.hasOwnProperty(r)){n.push(r)}}}return n}function o(e,t){for(var n in t){var i=t[n];r.removeAttr(i)}}function u(t,n){var u=i(t,n);var a=e.toJSON();a=i(a,n);var f=s(u,a);o(e,f);r.restore(u)}var r=new n(e);this.serialize=function(){var n=e.toJSON();n=i(n,t);return n};this.deserialize=function(e,n){n=_.extend({},t,n);u(e,n)}};var i=function(e,t){function r(){n=[]}var n;this.push=function(e){n.push(e)};this.pop=function(e){var t=n.pop();return t};this.rewind=function(){var e=n[0];r();return e};r()};e.Memento=t;return e.Memento})
